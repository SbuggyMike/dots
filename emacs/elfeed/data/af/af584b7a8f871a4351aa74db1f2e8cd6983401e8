<!-- SC_OFF --><div class="md"><p>Hi there! This is my first post.</p> <p>Long story short, I had a USB dongle that required being unplugged and replugged every time you rebooted. I&#39;d searched the entire web but couldn&#39;t find a fix.</p> <p>After many months, I found a method that worked for me, and wanted to share it so anyone with this dongle is spared from the extra workout. Feel free to correct anything.</p> <hr/> <p>The device is a Linksys AE1200, and USB databases list it as <strong>13b1:0039</strong> â€“ as you can see here: <a href="https://usb-ids.gowdy.us/read/UD/13b1/0039">https://usb-ids.gowdy.us/read/UD/13b1/0039</a></p> <p>The problem is that, when you reboot the PC, <strong>13b1:0039</strong> gets recognized as <strong>13b1:0bdc</strong>, which prevents it from loading the <em>brcmfmac</em> kernel module... Because &quot;0bdc&quot; is not a real product. A tedious workaround was to physically unplug and replug it, since it gets identified as &quot;0039&quot; the second time (you can confirm this by running <code>lsusb</code> before &amp; after replugging). </p> <p>After lots of troubleshooting, I found an automated way of doing this, without touching anything. The answer is based off of shodanex&#39;s reply to a similar issue: <a href="https://stackoverflow.com/q/442833">https://stackoverflow.com/q/442833</a></p> <p>It involves explicitly telling the drivers to also be used with the device&#39;s incorrect ID.</p> <h1>Steps to fix</h1> <p>Press Ctrl+Alt+T, or open your favorite terminal. All the following commands must be run as <code>sudo</code>, but I got &quot;permission denied&quot; when running it as-is. So, run <code>sudo -i</code> before anything. (if you get a prompt that says <code>#</code> instead of the regular <code>$</code>, you&#39;re all set)</p> <p>Because <em>brcmfmac</em> might not even be loaded, you may need to load it yourself. So type:</p> <p><code> modprobe brcmfmac </code></p> <p>Now for the actual fix, let&#39;s tell brcmfmac to also use this wrong ID:</p> <p><code> echo 13b1 0bdc &gt; /sys/bus/usb/drivers/brcmfmac/new_id </code></p> <p>This will make sure the device uses the <em>brcmfmac</em> module, even if its ID is incorrect. After a few seconds, the dongle should be recognized, allowing you to configure a WiFi network! You can do that through the GUI as usual or run <code>nmtui</code> on another terminal if you have it installed.</p> <p>If everything went well, you should have a working internet connection :)</p> <p>Now that we know it works, we can automate this by running a cronjob every time the system boots.</p> <p>Run:</p> <p><code> crontab -e </code> as superuser (which you should be, if you followed the steps), and you&#39;ll be shown an editor with an empty file. Paste the commands that fixed the issue in there (on different lines) and add &quot;@reboot&quot; at the start of both, like so:</p> <p><code>@reboot modprobe brcmfmac</code></p> <p><code>@reboot echo 13b1 0bdc &gt; /sys/bus/usb/drivers/brcmfmac/new_id</code></p> <p>This tells the system to run those commands (as <code>sudo</code>) every time you boot it. In case your distro doesn&#39;t support it, you can search for other methods.</p> <h2>More info</h2> <p>I tried a lot of things before coming up with this, and was about to give up on the issue. Luckily, someone else seems to have reported it: <a href="https://bugs.debian.org/cgi-bin/%3Ca%20href=%22bugreport.cgi?bug=1001189%22%3E1001189%3C/a%3E">https://bugs.debian.org/cgi-bin/%3Ca%20href=%22bugreport.cgi?bug=1001189%22%3E1001189%3C/a%3E</a></p> <p>Of course, it&#39;s not a bug from Debian, as other distros have the same issue. It should be the kernel, but don&#39;t know if it&#39;s been reported upstream yet.</p> <p>I hope this helps someone!</p> </div><!-- SC_ON --> &#32; submitted by &#32; <a href="https://www.reddit.com/user/alter_sapiens"> /u/alter_sapiens </a> <br/> <span><a href="https://www.reddit.com/r/linux/comments/wg28jo/fix_linksys_ae1200_13b10039/">[link]</a></span> &#32; <span><a href="https://www.reddit.com/r/linux/comments/wg28jo/fix_linksys_ae1200_13b10039/">[comments]</a></span>