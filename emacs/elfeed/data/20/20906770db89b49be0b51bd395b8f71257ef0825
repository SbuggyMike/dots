<!-- SC_OFF --><div class="md"><p>I&#39;m using <a href="https://wiki.archlinux.org/title/Dm-crypt/Encrypting_an_entire_system#LUKS_on_a_partition">LUKS on a partition</a> with systemd-boot and I&#39;m not using Secure Boot.</p> <pre><code>+----------------------------+ +---------------------------------------------------------------------------+ | | | | | EFI System Partition (ESP) | | LUKS2 encrypted partition | | | | | | | | | | | | | | FAT32 | | XFS | | /boot | | / | |----------------------------| |---------------------------------------------------------------------------| | /dev/nvme0n1p1 | | /dev/nvme0n1p2 | +----------------------------+ +---------------------------------------------------------------------------+ +----------------------------------------------------------------------------------------------------------+ | | | /dev/nvme0n1 | | | +----------------------------------------------------------------------------------------------------------+ </code></pre> <p>After some upgrades, my machine won&#39;t boot and I need run <code>mkinitcpio -p linux</code> from a USB drive. I do the following (clearly I keep these instructions handy lol):</p> <pre><code>cryptsetup open /dev/nvme0n1p2 cryptroot # type in password mount /dev/mapper/cryptroot /mnt mount /dev/nvme0n1p1 /mnt/boot arch-chroot /mnt cd /boot mkinitcpio -p linux exit umount -R /mnt reboot </code></pre> <p>I have <code>systemd-boot-update.service</code> enabled as per the <a href="https://wiki.archlinux.org/title/systemd-boot#systemd_service">wiki</a>.</p> <p>Here is the list of packages that was upgraded today that caused me to have to issues. I&quot;m guessing it&#39;s the <code>linux</code> kernel upgrade that triggered this. This has been happening for a few months, but I can&#39;t remember exactly when it started.</p> <pre><code>&gt; grep -i upgraded /var/log/pacman.log | grep 2023-05-15 [2023-05-15T16:57:22-0400] [ALPM] upgraded pam (1.5.2-2 -&gt; 1.5.3-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded libcap (2.68-1 -&gt; 2.69-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded attica (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded ki18n (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded karchive (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kconfig (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kcoreaddons (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded poppler (23.03.0-1 -&gt; 23.05.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded poppler-qt5 (23.03.0-1 -&gt; 23.05.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded sdl2 (2.26.5-1 -&gt; 2.26.5-2) [2023-05-15T16:57:22-0400] [ALPM] upgraded ffmpeg (2:6.0-5 -&gt; 2:6.0-6) [2023-05-15T16:57:22-0400] [ALPM] upgraded kfilemetadata (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kidletime (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded tpm2-tss (3.2.0-3 -&gt; 4.0.1-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded solid (5.105.0-2 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kwidgetsaddons (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kjobwidgets (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kdbusaddons (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kwindowsystem (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kcrash (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kglobalaccel (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kauth (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kcodecs (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kguiaddons (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:22-0400] [ALPM] upgraded kconfigwidgets (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kiconthemes (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kitemviews (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kxmlgui (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kbookmarks (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded knotifications (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kservice (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kwallet (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kcompletion (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded sonnet (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded ktextwidgets (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kded (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded kio (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded baloo (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded bluez-qt (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:23-0400] [ALPM] upgraded boost-libs (1.81.0-5 -&gt; 1.81.0-6) [2023-05-15T16:57:24-0400] [ALPM] upgraded breeze-icons (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded compiler-rt (15.0.7-1 -&gt; 15.0.7-2) [2023-05-15T16:57:24-0400] [ALPM] upgraded containerd (1.7.0-1 -&gt; 1.7.1-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded kpackage (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded syndication (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded knewstuff (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded frameworkintegration (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded fwupd (1.8.15-1 -&gt; 1.9.1-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded glslang (12.1.0-1 -&gt; 12.1.0-2) [2023-05-15T16:57:24-0400] [ALPM] upgraded imagemagick (7.1.1.8-1 -&gt; 7.1.1.9-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded poppler-glib (23.03.0-1 -&gt; 23.05.0-1) [2023-05-15T16:57:24-0400] [ALPM] upgraded tracker3 (3.5.1-1 -&gt; 3.5.2-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded inkscape (1.2.2-6 -&gt; 1.2.2-7) [2023-05-15T16:57:25-0400] [ALPM] upgraded libbpf (1.1.0-1 -&gt; 1.2.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded iproute2 (6.3.0-1 -&gt; 6.3.0-2) [2023-05-15T16:57:25-0400] [ALPM] upgraded jemalloc (1:5.3.0-1 -&gt; 1:5.3.0-2) [2023-05-15T16:57:25-0400] [ALPM] upgraded kactivities (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kactivities-stats (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kcalendarcore (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kdeclarative (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kcmutils (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kcontacts (1:5.105.0-1 -&gt; 1:5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kdav (1:5.105.0-1 -&gt; 1:5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kpty (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kdesu (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kparts (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kde-cli-tools (5.27.5-1 -&gt; 5.27.5.1-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kunitconversion (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kitemmodels (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kemoticons (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kdelibs4support (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kdnssd (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kdoctools (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded keepassxc (2.7.4-2 -&gt; 2.7.5-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kholidays (1:5.105.0-1 -&gt; 1:5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kjs (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded khtml (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kinit (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kirigami2 (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kitinerary (23.04.1-1 -&gt; 23.04.1-2) [2023-05-15T16:57:25-0400] [ALPM] upgraded knotifyconfig (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kpeople (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kquickcharts (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kross (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded kwayland (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded plasma-framework (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded threadweaver (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded krunner (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded syntax-highlighting (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:25-0400] [ALPM] upgraded ktexteditor (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:26-0400] [ALPM] upgraded libreoffice-fresh (7.5.3-1 -&gt; 7.5.3-2) [2023-05-15T16:57:27-0400] [ALPM] upgraded linux (6.3.1.arch2-1 -&gt; 6.3.2.arch1-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded mariadb-libs (10.11.2-2 -&gt; 10.11.3-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded mariadb-clients (10.11.2-2 -&gt; 10.11.3-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded mariadb (10.11.2-2 -&gt; 10.11.3-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded modemmanager-qt (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded networkmanager-qt (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded prison (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded purpose (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded python-pyudev (0.24.0-3 -&gt; 0.24.1-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded qqc2-desktop-style (5.105.0-1 -&gt; 5.106.0-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded ruby-bundler (2.4.1-1 -&gt; 2.4.12-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded unrar (1:6.2.6-1 -&gt; 1:6.2.7-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded virtualbox-host-modules-arch (7.0.8-7 -&gt; 7.0.8-8) [2023-05-15T16:57:27-0400] [ALPM] upgraded wireless-regdb (2023.02.13-1 -&gt; 2023.05.03-1) [2023-05-15T16:57:27-0400] [ALPM] upgraded xorg-setxkbmap (1.3.3-2 -&gt; 1.3.4-1) [2023-05-15T16:57:52-0400] [ALPM] upgraded joplin-appimage (2.9.17-1 -&gt; 2.10.18-1) </code></pre> </div><!-- SC_ON --> &#32; submitted by &#32; <a href="https://www.reddit.com/user/lmm7425"> /u/lmm7425 </a> <br/> <span><a href="https://www.reddit.com/r/archlinux/comments/13iqsur/why_does_my_system_sometimes_not_boot_after/">[link]</a></span> &#32; <span><a href="https://www.reddit.com/r/archlinux/comments/13iqsur/why_does_my_system_sometimes_not_boot_after/">[comments]</a></span>