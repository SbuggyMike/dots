Glasgow secure a first European final with a thrilling Challenge Cup semi-final victory over Scarlets in Llanelli.