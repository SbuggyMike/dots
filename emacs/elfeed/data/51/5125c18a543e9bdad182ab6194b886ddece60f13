<!-- SC_OFF --><div class="md"><p>After having the issue plague me for <a href="https://www.reddit.com/r/archlinux/comments/szh314/monitor_washed_out_colors_with_hdmi_thunderbolt_4/">5 months</a>, I finally figured out the fix. The issue is that monitors by default uses automatic settings for its <strong>Broadcast RGB Range</strong> where sometime it&#39;s incorrectly set to <strong>Limited Broadcast RGB Range</strong> (16-235 instead of 0-255, more info <a href="https://kodi.wiki/view/Video_levels_and_color_space">here</a>) resulting in washed out colours making the deepest black looking greyish and white not as bright etc. In my case, it&#39;s because I&#39;m using Intel iGPU (laptop) with an external monitor connected via HDMI to USB C thunderbolt port.</p> <p>&#x200B;</p> <p>The solution is easy on xorg with xrandr:</p> <pre><code>xrandr --output auto --set &quot;Broadcast RGB&quot; &quot;Full&quot; </code></pre> <p>&#x200B;</p> <p>For <strong>Wayland</strong> there wasn&#39;t much info online so it was quite difficult to find the solution: <strong><em>Use (libdrm) proptest to overide &#39;Broadcast RGB&#39; from automatic (0) to full (1) for your specific monitor before Wayland session is started.</em></strong></p> <p>The first step is to figure your affected device connector/monitor name (eDP-1, DP-1, DP-2, DP-3, DP-4, etc). If you&#39;re on gnome, install <code>gnome-randr-rust</code> and run <code>gnome-randr</code> and figure the monitor name from its output, etc mine was <code>DP-3</code> based on its resolution and refresh rate matching. There&#39;s also <code>wlr-randr</code> for other Wayland based DE/WM, otherwise you could use trial and error.</p> <p>Next step is to install proptest (libdrm), luckily it&#39;s available on the <a href="https://aur.archlinux.org/packages/libdrm-proptest">AUR</a> as <code>libdrm-proptest</code>.</p> <p>Run <code>proptest</code> (if the output is too long for the terminal to display, run <code>proptest &gt; output.txt</code> then open the file or <code>bat output.txt</code> etc)</p> <p>Find your Connector number from the display name, mine was <code>Connector 339 (DP-3)</code>. Also note that:</p> <pre><code>311 Broadcast RGB: flags: enum enums: Automatic=0 Full=1 Limited 16:235=2 value: 0 </code></pre> <p><em>means that it&#39;s currently set to automatic (0), check this again later to see if it&#39;s working.</em></p> <p>Run <code>ls /dev/dri</code> to figure which video card number, mine was <code>card0</code></p> <p>Assuming you&#39;re using Intel iGPU the command for the fix will be in this format:</p> <pre><code>/usr/bin/proptest -M i915 -D /dev/dri/card0 339 connector 311 1 </code></pre> <p><strong><em>i915</em></strong> is Intel iGPU, <strong><em>/dev/dri/card0</em></strong> is from <code>ls /dev/dri</code>, <strong><em>339 connector</em></strong> is from the output of <code>proptest</code> (Connector 339 (DP-3)) found earlier, <strong><em>311 1</em></strong> means setting property 311 Broadcast RGB to value of 1 (Full=1) to override automatic (0) to full Broadcast RGB Range.</p> <p>Where to place this command depends on your DE/WM, it just needs to run before Wayland session starts. I use gnome and found out I just need to add it to last line of <code>/etc/gdm/PreSession/Default</code>:</p> <pre><code>sudoedit /etc/gdm/PreSession/Default #!/bin/sh # # Note that any setup should come before the sessreg command as # that must be &#39;exec&#39;ed for the pid to be correct (sessreg uses the parent # pid) # # Note that output goes into the .xsession-errors file for easy debugging # PATH=&quot;/usr/bin:$PATH&quot; # iGPU Full Broadcast RGB Range USB C HDMI Fix # Connector 339 (DP-3) /usr/bin/proptest -M i915 -D /dev/dri/card0 339 connector 311 1 </code></pre> <p>Restart and you will finally get your precious colours back, you can run <code>proptest</code> again to verify (should be value: 1):</p> <pre><code>311 Broadcast RGB: flags: enum enums: Automatic=0 Full=1 Limited 16:235=2 value: 1 </code></pre> <p>&#x200B;</p> <p><em>Source:</em></p> <p><a href="https://www.reddit.com/r/linuxquestions/comments/qrpnkw/need_help_with_intel_graphics_broadcast_rgb_with/"><em>https://www.reddit.com/r/linuxquestions/comments/qrpnkw/need_help_with_intel_graphics_broadcast_rgb_with/</em></a></p> <p><a href="https://www.brad-x.com/2017/08/07/quick-tip-setting-the-color-space-value-in-wayland/"><em>https://www.brad-x.com/2017/08/07/quick-tip-setting-the-color-space-value-in-wayland/</em></a></p> <p><a href="https://forum.kodi.tv/showthread.php?tid=301776&amp;pid=2603950#pid2603950"><em>https://forum.kodi.tv/showthread.php?tid=301776&amp;pid=2603950#pid2603950</em></a></p> </div><!-- SC_ON --> &#32; submitted by &#32; <a href="https://www.reddit.com/user/Rnedoe"> /u/Rnedoe </a> <br/> <span><a href="https://www.reddit.com/r/archlinux/comments/wcdr3i/fix_wayland_limited_broadcast_rgb_range_washed/">[link]</a></span> &#32; <span><a href="https://www.reddit.com/r/archlinux/comments/wcdr3i/fix_wayland_limited_broadcast_rgb_range_washed/">[comments]</a></span>