<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">I'll eventually find the time to combine this script with the one that I describe in <a href="https://mac4translators.blogspot.com/2022/11/an-even-newer-version-of-my-capture-app.html" rel="nofollow" target="_blank">An even newer version of my Capture app</a>. For now, I call this script by saving it as an AppleScript application that I named "&gt;Emacs.app".</p><p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p><p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p><p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">####################################</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><b>use</b> </span><span style="color: #6c05d3; text-decoration: underline;">AppleScript</span><span style="color: black;"> </span><span style="color: blue;">version</span><span style="color: black;"> "2.4" </span>-- Yosemite (10.10) or later</p>
<p style="color: blue; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><b>use</b> </span><i>scripting additions</i></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># This is standard AppleScript with no extra.<span class="Apple-converted-space"> </span></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># No need to declare anything more than the scripting additions.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>property</b> <span style="color: #408000;">myEmacs</span> : "/Users/suzume/Documents/Repositories/emacs/nextstep/Emacs.app"</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>property</b> <span style="color: #408000;">myEmacsclient</span> : "/Users/suzume/Documents/Repositories/emacs/nextstep/Emacs.app/Contents/MacOS/bin/emacsclient"</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>property</b> <span style="color: #408000;">myEmacsFront</span> : <span style="color: #6c05d3; text-decoration: underline;"><i>false</i></span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># I decided to use properties instead of variables in this script.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: blue; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><b>tell</b> </span><i>application</i><span style="color: black;"> </span><span style="color: #408000;">myEmacs</span></p>
<p style="color: blue; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">	</span></span><span style="text-decoration: underline;"><b>activate</b></span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>end</b> <b>tell</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># Here, I activate Emacs, which has the effect to either put it at the front</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># or to launch it.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>repeat</b> <b>while</b> <span style="color: #408000;">myEmacsFront</span> = <span style="color: #6c05d3; text-decoration: underline;"><i>false</i></span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><b>try</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><b>tell</b> <span style="color: blue;"><i>application</i></span> "System Events" <b>to</b> <b>tell</b> <span style="color: blue;"><i>process</i></span> "Emacs" <b>to</b> <b>set</b> <span style="color: #6c05d3; text-decoration: underline;">frontmost</span> <b>to</b> <span style="color: #6c05d3; text-decoration: underline;"><i>true</i></span></p>
<p style="color: #408000; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><b>set</b> </span>myEmacsFront<span style="color: black;"> <b>to</b> </span><span style="color: #6c05d3; text-decoration: underline;"><i>true</i></span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><b>on</b> <b>error</b></p>
<p style="color: blue; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span></span><span style="text-decoration: underline;"><b>delay</b></span><span style="color: black;"> 1</span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><b>end</b> <b>try</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>end</b> <b>repeat</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># If Emacs is not launched, it may take some time to start it.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># In which case the script will error because Emacs won't be here</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># when the script needs it.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># So I loop every second on the myEmacsFront property that</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#<span class="Apple-converted-space">  </span>will eventually be set to true once Emacs is set to the front.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>tell</b> <span style="color: blue;"><i>application</i></span> "Finder"</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><b>set</b> <span style="color: #408000;">fileSelection</span> <b>to</b> <span style="color: #6c05d3; text-decoration: underline;">selection</span> <b>as</b> <span style="color: blue;"><i>alias list</i></span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>end</b> <b>tell</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># The Finder gives us the list of selected files.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>try</b></p>
<p style="color: #408000; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">	</span><b>repeat</b> <b>with</b> </span>selectedFile<span style="color: black;"> <b>in</b> </span>fileSelection</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><b>set</b> <span style="color: #408000;">myEditCommand</span> <b>to</b> <span style="color: #408000;">myEmacsclient</span> &amp; " -e \"(find-file \\\"" &amp; (<span style="color: #6c05d3; text-decoration: underline;">POSIX path</span> <b>of</b> <span style="color: #408000;">selectedFile</span>) &amp; "\\\")\" -n"</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><b>try</b></p>
<p style="color: #0016b0; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span></span><span style="text-decoration: underline;"><b>do shell script</b></span><span style="color: black;"> </span><span style="color: #408000;">myEditCommand</span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><b>on</b> <b>error</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><span style="color: #0016b0; text-decoration: underline;"><b>display alert</b></span> "Emacs can't open the file"</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span><b>end</b> <b>try</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-tab-span" style="white-space: pre;">	</span></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><b>end</b> <b>repeat</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>on</b> <b>error</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><span class="Apple-tab-span" style="white-space: pre;">	</span><span style="color: #0016b0; text-decoration: underline;"><b>display alert</b></span> "The script can't find the file"</p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><b>end</b> <b>try</b></p>
<p style="color: black; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"><br /></p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># This is the core of the script. It asks emacsclient to evaluate</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># (find-file "file path").</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># The error messages try to describe the error location.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># The only difficult part in this script was the escape sequences</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;"># needed to create myEditCommand.</p>
<p style="color: #1d1e1e; font-family: Verdana; font-style: normal; font-weight: normal; font: 14.0px Verdana; line-height: normal; margin: 0px;">#########</p>
<div class="blogger-post-footer"><hr />
<a href="http://mac4translators.blogspot.com/2008/02/mac-for-translators-mailing-list.html">Mac for Translators, the discussion group...</a>
<hr /></div>