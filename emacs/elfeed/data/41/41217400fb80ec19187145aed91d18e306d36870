Dundee win an eight-goal thriller against Queen's Park in a winner-takes-all title clash to finish top of the Scottish Championship.