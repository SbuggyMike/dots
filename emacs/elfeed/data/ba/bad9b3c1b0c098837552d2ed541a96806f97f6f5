Mark Selby withstands a dramatic Mark Allen fightback to win a late-night finish 17-15 as he reaches his sixth World Championship final.